<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Defender</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1a3e 50%, #2d1b4e 100%);
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }

        .game-container {
            text-align: center;
            position: relative;
        }

        h1 {
            color: #fff;
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(138, 43, 226, 0.8);
            letter-spacing: 3px;
        }

        canvas {
            border: 3px solid #8a2be2;
            border-radius: 10px;
            box-shadow: 0 0 40px rgba(138, 43, 226, 0.5);
            background: #000;
        }

        .ui {
            position: absolute;
            top: 80px;
            left: 20px;
            color: #fff;
            font-size: 1.2em;
            text-align: left;
        }

        .score, .lives, .level {
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(138, 43, 226, 0.8);
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 40px;
            border-radius: 20px;
            border: 2px solid #8a2be2;
            display: none;
        }

        .game-over h2 {
            color: #ff4444;
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(255, 68, 68, 0.8);
        }

        .game-over p {
            color: #fff;
            font-size: 1.5em;
            margin-bottom: 30px;
        }

        .restart-btn {
            background: linear-gradient(135deg, #8a2be2, #4a148c);
            color: #fff;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(138, 43, 226, 0.4);
        }

        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 25px rgba(138, 43, 226, 0.6);
        }

        .instructions {
            color: #aaa;
            margin-top: 20px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>üöÄ SPACE DEFENDER üöÄ</h1>
        <div class="ui">
            <div class="score">Score: <span id="score">0</span></div>
            <div class="lives">Lives: <span id="lives">3</span></div>
            <div class="level">Level: <span id="level">1</span></div>
        </div>
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <div class="instructions">Use ‚Üê ‚Üí arrows to move | SPACE to shoot</div>
        <div class="game-over" id="gameOver">
            <h2>GAME OVER</h2>
            <p>Final Score: <span id="finalScore">0</span></p>
            <button class="restart-btn" onclick="restartGame()">Play Again</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let gameState = {
            player: { x: 375, y: 550, w: 50, h: 40, speed: 5 },
            bullets: [],
            enemies: [],
            particles: [],
            score: 0,
            lives: 3,
            level: 1,
            gameOver: false,
            keys: {},
            enemySpeed: 1,
            spawnRate: 0.02
        };

        // Starfield background
        const stars = Array.from({length: 100}, () => ({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            size: Math.random() * 2,
            speed: Math.random() * 0.5 + 0.2
        }));

        function drawStars() {
            ctx.fillStyle = '#fff';
            stars.forEach(s => {
                ctx.beginPath();
                ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
                ctx.fill();
                s.y += s.speed;
                if (s.y > canvas.height) {
                    s.y = 0;
                    s.x = Math.random() * canvas.width;
                }
            });
        }

        function drawPlayer() {
            const p = gameState.player;
            // Ship body
            ctx.fillStyle = '#00ffff';
            ctx.beginPath();
            ctx.moveTo(p.x + p.w/2, p.y);
            ctx.lineTo(p.x, p.y + p.h);
            ctx.lineTo(p.x + p.w, p.y + p.h);
            ctx.closePath();
            ctx.fill();
            
            // Glow effect
            ctx.shadowBlur = 20;
            ctx.shadowColor = '#00ffff';
            ctx.fill();
            ctx.shadowBlur = 0;
            
            // Cockpit
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(p.x + p.w/2, p.y + 15, 5, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawBullet(b) {
            ctx.fillStyle = '#ffff00';
            ctx.shadowBlur = 15;
            ctx.shadowColor = '#ffff00';
            ctx.fillRect(b.x - 2, b.y, 4, 15);
            ctx.shadowBlur = 0;
        }

        function drawEnemy(e) {
            ctx.fillStyle = e.color;
            ctx.shadowBlur = 15;
            ctx.shadowColor = e.color;
            ctx.beginPath();
            ctx.moveTo(e.x + e.w/2, e.y + e.h);
            ctx.lineTo(e.x, e.y);
            ctx.lineTo(e.x + e.w, e.y);
            ctx.closePath();
            ctx.fill();
            ctx.shadowBlur = 0;
        }

        function createParticles(x, y, color) {
            for (let i = 0; i < 15; i++) {
                gameState.particles.push({
                    x, y,
                    vx: (Math.random() - 0.5) * 6,
                    vy: (Math.random() - 0.5) * 6,
                    color,
                    life: 30
                });
            }
        }

        function drawParticles() {
            gameState.particles.forEach((p, i) => {
                ctx.fillStyle = p.color;
                ctx.globalAlpha = p.life / 30;
                ctx.fillRect(p.x, p.y, 3, 3);
                p.x += p.vx;
                p.y += p.vy;
                p.life--;
                if (p.life <= 0) gameState.particles.splice(i, 1);
            });
            ctx.globalAlpha = 1;
        }

        function spawnEnemy() {
            const colors = ['#ff0066', '#ff6600', '#ff00ff', '#00ff00'];
            gameState.enemies.push({
                x: Math.random() * (canvas.width - 40),
                y: -40,
                w: 40,
                h: 30,
                color: colors[Math.floor(Math.random() * colors.length)]
            });
        }

        function checkCollision(rect1, rect2) {
            return rect1.x < rect2.x + rect2.w &&
                   rect1.x + rect1.w > rect2.x &&
                   rect1.y < rect2.y + rect2.h &&
                   rect1.y + rect1.h > rect2.y;
        }

        function updateGame() {
            if (gameState.gameOver) return;

            // Move player
            if (gameState.keys['ArrowLeft'] && gameState.player.x > 0) {
                gameState.player.x -= gameState.player.speed;
            }
            if (gameState.keys['ArrowRight'] && gameState.player.x < canvas.width - gameState.player.w) {
                gameState.player.x += gameState.player.speed;
            }

            // Move bullets
            gameState.bullets.forEach((b, i) => {
                b.y -= 7;
                if (b.y < 0) gameState.bullets.splice(i, 1);
            });

            // Spawn and move enemies
            if (Math.random() < gameState.spawnRate) spawnEnemy();
            
            gameState.enemies.forEach((e, i) => {
                e.y += gameState.enemySpeed;
                
                // Check bullet collision
                gameState.bullets.forEach((b, j) => {
                    if (checkCollision(e, {x: b.x-2, y: b.y, w: 4, h: 15})) {
                        createParticles(e.x + e.w/2, e.y + e.h/2, e.color);
                        gameState.enemies.splice(i, 1);
                        gameState.bullets.splice(j, 1);
                        gameState.score += 10;
                        document.getElementById('score').textContent = gameState.score;
                        
                        // Level up
                        if (gameState.score % 100 === 0) {
                            gameState.level++;
                            gameState.enemySpeed += 0.3;
                            gameState.spawnRate += 0.005;
                            document.getElementById('level').textContent = gameState.level;
                        }
                    }
                });

                // Check player collision
                if (checkCollision(e, gameState.player)) {
                    createParticles(e.x + e.w/2, e.y + e.h/2, '#ff0000');
                    gameState.enemies.splice(i, 1);
                    gameState.lives--;
                    document.getElementById('lives').textContent = gameState.lives;
                    
                    if (gameState.lives <= 0) {
                        gameState.gameOver = true;
                        document.getElementById('finalScore').textContent = gameState.score;
                        document.getElementById('gameOver').style.display = 'block';
                    }
                }

                if (e.y > canvas.height) gameState.enemies.splice(i, 1);
            });
        }

        function draw() {
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            drawStars();
            drawPlayer();
            gameState.bullets.forEach(drawBullet);
            gameState.enemies.forEach(drawEnemy);
            drawParticles();
        }

        function gameLoop() {
            updateGame();
            draw();
            requestAnimationFrame(gameLoop);
        }

        function restartGame() {
            gameState = {
                player: { x: 375, y: 550, w: 50, h: 40, speed: 5 },
                bullets: [],
                enemies: [],
                particles: [],
                score: 0,
                lives: 3,
                level: 1,
                gameOver: false,
                keys: gameState.keys,
                enemySpeed: 1,
                spawnRate: 0.02
            };
            document.getElementById('score').textContent = '0';
            document.getElementById('lives').textContent = '3';
            document.getElementById('level').textContent = '1';
            document.getElementById('gameOver').style.display = 'none';
        }

        // Controls
        document.addEventListener('keydown', e => {
            gameState.keys[e.key] = true;
            if (e.key === ' ' && !gameState.gameOver) {
                e.preventDefault();
                gameState.bullets.push({
                    x: gameState.player.x + gameState.player.w / 2,
                    y: gameState.player.y
                });
            }
        });

        document.addEventListener('keyup', e => {
            gameState.keys[e.key] = false;
        });

        gameLoop();
    </script>
</body>
</html>
